import{s as b}from"./indexeddb.83dbb9f7.js";import{C as ae,f as l,g as te,D as se,d as h,q as ne,r as f,o as oe,c as ie,b as a,w as n,F as le,a as k,e as m,G as W,B as ce,E as de}from"./index.c8307d61.js";import{t as L,c as re}from"./method.59eeced5.js";const ue={name:"\u4F20\u8BB0",version:1,list:[{id:"K",name:"K",best:"22",special:"11",first:"12",second:"21"},{id:"baShenAn",name:"\u516B\u795E\u5EB5",best:"2",special:"11",first:"11",second:"\u65E0"},{id:"baWangWan",name:"\u9738\u738B\u4E38",best:"122",special:"2",first:"11",second:"121"},{id:"banQiBaiHe",name:"\u5742\u5D0E\u767E\u5408",best:"11",special:"21",first:"12",second:"22"},{id:"banQiLiang",name:"\u5742\u5D0E\u826F",best:"22",special:"212",first:"1",second:"211"},{id:"biLiKaiEn",name:"\u6BD4\u5229\u51EF\u6069",best:"22",special:"12",first:"11",second:"21"},{id:"buLuMaLi",name:"\u5E03\u9C81\u739B\u4E3D",best:"122",special:"2",first:"11",second:""},{id:"buZhiHuoWu",name:"\u4E0D\u77E5\u706B\u821E",best:"22",special:"21",first:"11",second:""},{id:"caoTiChaiZhou",name:"\u8349\u8599\u67F4\u821F",best:"22",special:"21",first:"11",second:"12"},{id:"caoTiJing",name:"\u8349\u8599\u4EAC",best:"22",special:"11",first:"12",second:"21"},{id:"daMenWuLang",name:"\u5927\u95E8\u4E94\u90CE",best:"12",special:"11",first:"2",second:"\u65E0"},{id:"dongZhang",name:"\u4E1C\u4E08",best:"12",special:"22",first:"11",second:"21"},{id:"erJieTangHongWan",name:"\u4E8C\u9636\u5802\u7EA2\u4E38",best:"22",special:"21",first:"11",second:"12"},{id:"feng",name:"\u67AB",best:"22",special:"21",first:"1",second:"\u65E0"},{id:"fuBuBanCang",name:"\u670D\u90E8\u534A\u85CF",best:"11",special:"21\uFF0C22",first:"12",second:"\u65E0"},{id:"huangKuangDianGuangXiaErMei",name:"\u8352\u72C2\u7535\u5149\u590F\u5C14\u7F8E",best:"22",special:"12",first:"",second:""},{id:"jiSiHuoHuaDe",name:"\u5409\u65AF\u970D\u534E\u5FB7",best:"12",special:"21",first:"22",second:"11"},{id:"jiaShenShenZhiJie",name:"\u5609\u795E\u614E\u4E4B\u4ECB",best:"21",special:"11",first:"12",second:"22"},{id:"juYouJing",name:"\u6A58\u53F3\u4EAC",best:"22",special:"12",first:"",second:"21"},{id:"keLaKe",name:"\u514B\u62C9\u514B",best:"22",special:"21",first:"11",second:"12"},{id:"kuLa",name:"\u5E93\u62C9",best:"12",special:"11",first:"2",second:"\u65E0"},{id:"liMuLouLou",name:"\u8389\u59C6\u9732\u9732",best:"211",special:"212",first:"",second:""},{id:"luKaEr",name:"\u5362\u5361\u5C14",best:"12",special:"22",first:"21",second:""},{id:"luoBoTe",name:"\u7F57\u4F2F\u7279",best:"11",special:"12",first:"21",second:"22"},{id:"maGongYaDianNa",name:"\u9EBB\u5BAB\u96C5\u5178\u5A1C",best:"22",special:"21",first:"1",second:"3"},{id:"maKeXiMa",name:"\u9A6C\u514B\u897F\u9A6C",best:"1",special:"21",first:"22",second:"3"},{id:"naKeLouLou",name:"\u5A1C\u53EF\u9732\u9732",best:"21",special:"22",first:"12",second:"11"},{id:"qianLiangKuangSiLang",name:"\u5343\u4E24\u72C2\u6B7B\u90CE",best:"12",special:"11",first:"21",second:"22"},{id:"shenLeQianHe",name:"\u795E\u4E50\u5343\u9E64",best:"12",special:"22",first:"11",second:"21"},{id:"teRuiBoJiaDe",name:"\u7279\u745E\u535A\u52A0\u5FB7",best:"22",special:"11",first:"21",second:"12"},{id:"weiPu",name:"\u8587\u666E",best:"111",special:"112",first:"12",second:"2"},{id:"yaShenHuanShiLang",name:"\u7259\u795E\u5E7B\u5341\u90CE",best:"12",special:"11",first:"",second:"21"},{id:"yanZhiSuMingKeLiSi",name:"\u708E\u4E4B\u5BBF\u547D\u514B\u91CC\u65AF",best:"22",special:"21",first:"11",second:"12"},{id:"yuMingFangShouShi",name:"\u5FA1\u540D\u65B9\u5B88\u77E2",best:"12",special:"22",first:"11",second:"21"},{id:"zhuiQuanChong",name:"\u690E\u62F3\u5D07",best:"22",special:"11\uFF0C21",first:"12",second:"\u65E0"}]},fe=m("\u641C\u7D22"),me=m("\u91CD\u7F6E"),pe=m("\u6DFB\u52A0"),ve=m("\u5BFC\u51FA"),be=m("\u5BFC\u5165"),ge={class:"td-opr"},_e=["onClick"],ye=["onClick"],he=m("\u4FDD\u5B58"),ke=m("\u53D6\u6D88"),xe={__name:"index",setup(Ve){const x=ae("state"),S=[{key:"name",name:"\u4EBA\u7269"},{key:"best",name:"\u5B8C\u7F8E\u7ED3\u5C40"},{key:"special",name:"\u7279\u6B8A\u7ED3\u5C40"},{key:"first",name:"\u7ED3\u5C40\u4E00"},{key:"second",name:"\u7ED3\u5C40\u4E8C"},{key:"opr",name:"\u64CD\u4F5C"}],K=l([]),M=l(0),D=l(1),U=l(20),g=l({name:""}),j=l({});te(async()=>{const{version:s,list:e}=ue;await se(b,s,e,!0),V()});async function V(){x.loading=!0;const s=await h.findPage({store:b.store,index:"id",page:D.value,pageSize:U.value,filter:Z});M.value=s.total,K.value=s.list,x.loading=!1}function Z(s){const{name:e}=j.value;return!e||new RegExp(e,"i").test(s.name)}function $(){g.value={name:""},R()}function R(){j.value={...g.value},E(1)}function E(s){D.value=s,V()}const p=l(!1),F=l(),o=l({name:"",best:"",special:"",first:"",second:""}),q=ne({name:[{required:!0,message:"\u8BF7\u8F93\u5165"}]}),w=l(!1);function Q(){o.value={id:"",name:"",best:"",special:"",first:"",second:""},p.value=!0}function G(s){o.value={...s},p.value=!0}async function I(){if(!!F.value.validForm())try{w.value=!0,o.value.id=W(o.value.name),await h.set({store:b.store,val:ce(o.value)}),p.value=!1,w.value=!1,L({message:"\u4FDD\u5B58\u6210\u529F",type:"success"}),await V()}catch{w.value=!1}}function H(){p.value=!1}async function Y(s){try{const{id:e}=s;if(await re({message:"\u786E\u5B9A\u8981\u5220\u9664\u5417?"})!==1)return;await h.del({store:b.store,start:e,end:e}),L({message:"\u5220\u9664\u6210\u529F",type:"success"}),await V()}catch(e){console.log(e)}}const J=l(),T=l();function A(){J.value.click()}function X(s){const e=s.target.files[0];T.value.reset();const{type:d}=e;if(!/csv/i.test(d))return L({message:"\u53EA\u80FD\u4E0A\u4F20csv\u6587\u4EF6",type:"error"});const c=new FileReader;c.onload=async i=>{try{const u=i.target.result.split(`\r
`),v=u.shift().split(","),_={};let t=-1;for(let[C,y]of v.entries())_[y]=C,y==="\u4EBA\u7269"&&(t=C);if(t<0)throw"\u6570\u636E\u683C\u5F0F\u9519\u8BEF";const B=u.map(C=>{const y=C.split(","),z={id:W(y[t])};for(let ee of S){const{key:N,name:P}=ee;N!=="opr"&&(z[N]=typeof _[P]=="number"?y[_[P]]:"")}return z});await h.set({store:b.store,val:B}),R()}catch(r){console.error(r),L({message:"\u5BFC\u5165\u6570\u636E\u51FA\u9519",type:"error"})}},c.readAsText(e)}async function O(){const s=await h.find({store:b.store,index:"id"});if(!x.isProd){console.log(JSON.stringify(s));return}let e=["\u4EBA\u7269,\u5B8C\u7F8E\u7ED3\u5C40,\u7279\u6B8A\u7ED3\u5C40,\u7ED3\u5C40\u4E00,\u7ED3\u5C40\u4E8C"];for(let r of s){const u=[];for(let v of S)v.key!=="opr"&&u.push(r[v.key]);e.push(u.toString())}const c=`data:text:csv;charset=utf-8,\uFEFF${encodeURIComponent(e.join(`\r
`))}`,i=document.createElement("a");i.href=c,i.download=`\u4F20\u8BB0-${de(new Date,"yyyyMMdd-hhmm")}.csv`,i.click()}return(s,e)=>{const d=f("v-input"),c=f("v-form-item"),i=f("v-button"),r=f("v-form"),u=f("v-table"),v=f("v-pages"),_=f("v-dialog");return oe(),ie(le,null,[a(r,{class:"v-form-search","label-width":"50px",model:g.value},{default:n(()=>[a(c,{label:"\u540D\u79F0"},{default:n(()=>[a(d,{modelValue:g.value.name,"onUpdate:modelValue":e[0]||(e[0]=t=>g.value.name=t)},null,8,["modelValue"])]),_:1}),a(i,{type:"primary",onClick:R},{default:n(()=>[fe]),_:1}),a(i,{onClick:$},{default:n(()=>[me]),_:1}),a(i,{type:"success",onClick:Q},{default:n(()=>[pe]),_:1}),a(i,{onClick:O},{default:n(()=>[ve]),_:1}),a(i,{onClick:A},{default:n(()=>[be]),_:1}),k("form",{ref_key:"fileFormRef",ref:T},[k("input",{type:"file",accept:".csv",ref_key:"fileRef",ref:J,onChange:X},null,544)],512)]),_:1},8,["model"]),a(u,{class:"v-table-story with-search-page",cols:S,data:K.value},{opr:n(({row:t})=>[k("div",ge,[k("a",{href:"javascript: void(0);",onClick:B=>G(t)},"\u4FEE\u6539",8,_e),k("a",{href:"javascript: void(0);",onClick:B=>Y(t)},"\u5220\u9664",8,ye)])]),_:1},8,["data"]),a(v,{total:M.value,page:D.value,size:U.value,"onUpdate:page":E},null,8,["total","page","size"]),a(_,{modelValue:p.value,"onUpdate:modelValue":e[6]||(e[6]=t=>p.value=t),title:"\u4F20\u8BB0\u66F4\u65B0",onClose:H},{footer:n(()=>[a(i,{type:"primary",onClick:I,disabled:w.value},{default:n(()=>[he]),_:1},8,["disabled"]),a(i,{onClick:H},{default:n(()=>[ke]),_:1})]),default:n(()=>[a(r,{ref_key:"formRef",ref:F,model:o.value,rules:q,"label-width":"80px"},{default:n(()=>[a(c,{label:"\u4EBA\u7269",prop:"name"},{default:n(()=>[a(d,{modelValue:o.value.name,"onUpdate:modelValue":e[1]||(e[1]=t=>o.value.name=t)},null,8,["modelValue"])]),_:1}),a(c,{label:"\u5B8C\u7F8E\u7ED3\u5C40"},{default:n(()=>[a(d,{modelValue:o.value.best,"onUpdate:modelValue":e[2]||(e[2]=t=>o.value.best=t)},null,8,["modelValue"])]),_:1}),a(c,{label:"\u7279\u6B8A\u7ED3\u5C40"},{default:n(()=>[a(d,{modelValue:o.value.special,"onUpdate:modelValue":e[3]||(e[3]=t=>o.value.special=t)},null,8,["modelValue"])]),_:1}),a(c,{label:"\u7ED3\u5C40\u4E00"},{default:n(()=>[a(d,{modelValue:o.value.first,"onUpdate:modelValue":e[4]||(e[4]=t=>o.value.first=t)},null,8,["modelValue"])]),_:1}),a(c,{label:"\u7ED3\u5C40\u4E8C"},{default:n(()=>[a(d,{modelValue:o.value.second,"onUpdate:modelValue":e[5]||(e[5]=t=>o.value.second=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}};export{xe as default};
