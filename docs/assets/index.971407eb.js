import{s as v}from"./indexeddb.83dbb9f7.js";import{C as ae,f as i,g as te,D as se,d as y,q as ne,r as f,o as oe,c as le,b as a,w as n,F as ie,a as h,e as m,E as W,B as ce}from"./index.08c2fa32.js";import{t as C,c as de}from"./method.c43d68e7.js";const re={name:"\u4F20\u8BB0",version:1,list:[{id:"K",name:"K",best:"22",special:"11",first:"12",second:"21"},{id:"baWangWan",name:"\u9738\u738B\u4E38",best:"122",special:"2",first:"11",second:"121"},{id:"banQiBaiHe",name:"\u5742\u5D0E\u767E\u5408",best:"11",special:"21",first:"12",second:"22"},{id:"banQiLiang",name:"\u5742\u5D0E\u826F",best:"22",special:"212",first:"1",second:"211"},{id:"biLiKaiEn",name:"\u6BD4\u5229\u51EF\u6069",best:"22",special:"12",first:"11",second:"21"},{id:"buZhiHuoWu",name:"\u4E0D\u77E5\u706B\u821E",best:"22",special:"21",first:"",second:""},{id:"caoTiChaiZhou",name:"\u8349\u8599\u67F4\u821F",best:"22",special:"21",first:"11",second:"12"},{id:"caoTiJing",name:"\u8349\u8599\u4EAC",best:"22",special:"11",first:"12",second:"21"},{id:"daMenWuLang",name:"\u5927\u95E8\u4E94\u90CE",best:"12",special:"11",first:"",second:"2"},{id:"dongZhang",name:"\u4E1C\u4E08",best:"12",special:"22",first:"11",second:"21"},{id:"erJieTangHongWan",name:"\u4E8C\u9636\u5802\u7EA2\u4E38",best:"22",special:"21",first:"11",second:"12"},{id:"feng",name:"\u67AB",best:"22",special:"21",first:"1",second:""},{id:"fuBuBanCang",name:"\u670D\u90E8\u534A\u85CF",best:"11",special:"22",first:"",second:""},{id:"jiSiHuoHuaDe",name:"\u5409\u65AF\u970D\u534E\u5FB7",best:"12",special:"21",first:"22",second:"11"},{id:"juYouJing",name:"\u6A58\u53F3\u4EAC",best:"22",special:"12",first:"",second:"21"},{id:"keLaKe",name:"\u514B\u62C9\u514B",best:"22",special:"21",first:"11",second:"12"},{id:"kuLa",name:"\u5E93\u62C9",best:"12",special:"11",first:"2",second:""},{id:"liMuLouLou",name:"\u8389\u59C6\u9732\u9732",best:"211",special:"212",first:"",second:""},{id:"luKaEr",name:"\u5362\u5361\u5C14",best:"12",special:"22",first:"21",second:""},{id:"luoBoTe",name:"\u7F57\u4F2F\u7279",best:"11",special:"12",first:"",second:""},{id:"maGongYaDianNa",name:"\u9EBB\u5BAB\u96C5\u5178\u5A1C",best:"22",special:"21",first:"1",second:"3"},{id:"maKeXiMa",name:"\u9A6C\u514B\u897F\u9A6C",best:"1",special:"21",first:"",second:"3"},{id:"naKeLouLou",name:"\u5A1C\u53EF\u9732\u9732",best:"",special:"",first:"12",second:"11"},{id:"qianLiangKuangSiLang",name:"\u5343\u4E24\u72C2\u6B7B\u90CE",best:"12",special:"11",first:"21",second:"22"},{id:"shenLeQianHe",name:"\u795E\u4E50\u5343\u9E64",best:"12",special:"",first:"21",second:""},{id:"teRuiBoJiaDe",name:"\u7279\u745E\u535A\u52A0\u5FB7",best:"22",special:"11",first:"21",second:"12"},{id:"weiPu",name:"\u8587\u666E",best:"111",special:"112",first:"12",second:"2"},{id:"yaShenHuanShiLang",name:"\u7259\u795E\u5E7B\u5341\u90CE",best:"12",special:"11",first:"",second:"21"},{id:"yanZhiSuMingKeLiSi",name:"\u708E\u4E4B\u5BBF\u547D\u514B\u91CC\u65AF",best:"",special:"",first:"11",second:"12"},{id:"yuMingFangShouShi",name:"\u5FA1\u540D\u65B9\u5B88\u77E2",best:"12",special:"22",first:"",second:""},{id:"zhuiQuanChong",name:"\u690E\u62F3\u5D07",best:"22",special:"11\uFF0C21",first:"12",second:""}]};const ue=m("\u641C\u7D22"),fe=m("\u91CD\u7F6E"),me=m("\u6DFB\u52A0"),pe=m("\u5BFC\u51FA"),ve=m("\u5BFC\u5165"),be={class:"td-opr"},_e=["onClick"],ge=["onClick"],ye=m("\u4FDD\u5B58"),he=m("\u53D6\u6D88"),we={__name:"index",setup(ke){const w=ae("state"),L=[{key:"name",name:"\u4EBA\u7269"},{key:"best",name:"\u5B8C\u7F8E\u7ED3\u5C40"},{key:"special",name:"\u7279\u6B8A\u7ED3\u5C40"},{key:"first",name:"\u7ED3\u5C40\u4E00"},{key:"second",name:"\u7ED3\u5C40\u4E8C"},{key:"opr",name:"\u64CD\u4F5C"}],U=i([]),D=i(0),S=i(1),j=i(20),b=i({name:""}),E=i({});te(async()=>{const{version:s,list:e}=re;await se(v,s,e,!0),k()});async function k(){w.loading=!0;const s=await y.findPage({store:v.store,index:"id",page:S.value,pageSize:j.value,filter:q});D.value=s.total,U.value=s.list,w.loading=!1}function q(s){const{name:e}=E.value;return!e||new RegExp(e,"i").test(s.name)}function Q(){b.value={name:""},R()}function R(){E.value={...b.value},F(1)}function F(s){S.value=s,k()}const p=i(!1),H=i(),o=i({name:"",best:"",special:"",first:"",second:""}),Z=ne({name:[{required:!0,message:"\u8BF7\u8F93\u5165"}]}),V=i(!1);function I(){o.value={id:"",name:"",best:"",special:"",first:"",second:""},p.value=!0}function Y(s){o.value={...s},p.value=!0}async function $(){if(!!H.value.validForm())try{V.value=!0,o.value.id=W(o.value.name),await y.set({store:v.store,val:ce(o.value)}),p.value=!1,V.value=!1,C({message:"\u4FDD\u5B58\u6210\u529F",type:"success"}),await k()}catch(e){console.log(e),V.value=!1}}function M(){p.value=!1}async function A(s){try{const{id:e}=s;if(await de({message:"\u786E\u5B9A\u8981\u5220\u9664\u5417?"})!==1)return;await y.del({store:v.store,start:e,end:e}),C({message:"\u5220\u9664\u6210\u529F",type:"success"}),await k()}catch(e){console.log(e)}}const T=i(),z=i();function G(){T.value.click()}function O(s){const e=s.target.files[0];z.value.reset();const{type:c}=e;if(!/excel|sheet|csv/i.test(c))return C({message:"\u53EA\u80FD\u4E0A\u4F20Excel\u6587\u4EF6",type:"error"});const l=new FileReader;l.onload=async d=>{try{const u=d.target.result.split(`\r
`),B=u.shift().split(","),_={};let t=-1;for(let[x,g]of B.entries())_[g]=x,g==="\u4EBA\u7269"&&(t=x);if(t<0)throw"\u6570\u636E\u683C\u5F0F\u9519\u8BEF";const K=u.map(x=>{const g=x.split(","),J={id:W(g[t])};for(let ee of L){const{key:N,name:P}=ee;N!=="opr"&&(J[N]=typeof _[P]=="number"?g[_[P]]:"")}return J});await y.set({store:v.store,val:K}),R()}catch(r){console.error(r),C({message:"\u5BFC\u5165\u6570\u636E\u51FA\u9519",type:"error"})}},l.readAsText(e)}async function X(){const s=await y.find({store:v.store,index:"id"});if(!w.isProd){console.log(JSON.stringify(s));return}let e=["\u4EBA\u7269,\u5B8C\u7F8E\u7ED3\u5C40,\u7279\u6B8A\u7ED3\u5C40,\u7ED3\u5C40\u4E00,\u7ED3\u5C40\u4E8C"];for(let d of s){const r=[];for(let u of L)u.key!=="opr"&&r.push(d[u.key]);e.push(r.toString())}const c="data:application/vnd.ms-excel;charset=utf-8,\uFEFF"+encodeURIComponent(e.join(`\r
`)),l=document.createElement("a");l.href=c,l.download="\u4F20\u8BB0.xls",l.click()}return(s,e)=>{const c=f("v-input"),l=f("v-form-item"),d=f("v-button"),r=f("v-form"),u=f("v-table"),B=f("v-pages"),_=f("v-dialog");return oe(),le(ie,null,[a(r,{class:"v-form-search","label-width":"50px",model:b.value},{default:n(()=>[a(l,{label:"\u540D\u79F0"},{default:n(()=>[a(c,{modelValue:b.value.name,"onUpdate:modelValue":e[0]||(e[0]=t=>b.value.name=t)},null,8,["modelValue"])]),_:1}),a(d,{type:"primary",onClick:R},{default:n(()=>[ue]),_:1}),a(d,{onClick:Q},{default:n(()=>[fe]),_:1}),a(d,{type:"success",onClick:I},{default:n(()=>[me]),_:1}),a(d,{onClick:X},{default:n(()=>[pe]),_:1}),a(d,{onClick:G},{default:n(()=>[ve]),_:1}),h("form",{ref_key:"fileFormRef",ref:z},[h("input",{type:"file",accept:".xls,.xlsx,.csv",ref_key:"fileRef",ref:T,onChange:O},null,544)],512)]),_:1},8,["model"]),a(u,{class:"v-table-story with-search-page",cols:L,data:U.value},{opr:n(({row:t})=>[h("div",be,[h("a",{href:"javascript: void(0);",onClick:K=>Y(t)},"\u4FEE\u6539",8,_e),h("a",{href:"javascript: void(0);",onClick:K=>A(t)},"\u5220\u9664",8,ge)])]),_:1},8,["data"]),a(B,{total:D.value,page:S.value,size:j.value,"onUpdate:page":F},null,8,["total","page","size"]),a(_,{modelValue:p.value,"onUpdate:modelValue":e[6]||(e[6]=t=>p.value=t),title:"\u4F20\u8BB0\u66F4\u65B0",onClose:M},{footer:n(()=>[a(d,{type:"primary",onClick:$,disabled:V.value},{default:n(()=>[ye]),_:1},8,["disabled"]),a(d,{onClick:M},{default:n(()=>[he]),_:1})]),default:n(()=>[a(r,{ref_key:"formRef",ref:H,model:o.value,rules:Z,"label-width":"80px"},{default:n(()=>[a(l,{label:"\u4EBA\u7269",prop:"name"},{default:n(()=>[a(c,{modelValue:o.value.name,"onUpdate:modelValue":e[1]||(e[1]=t=>o.value.name=t)},null,8,["modelValue"])]),_:1}),a(l,{label:"\u5B8C\u7F8E\u7ED3\u5C40"},{default:n(()=>[a(c,{modelValue:o.value.best,"onUpdate:modelValue":e[2]||(e[2]=t=>o.value.best=t)},null,8,["modelValue"])]),_:1}),a(l,{label:"\u7279\u6B8A\u7ED3\u5C40"},{default:n(()=>[a(c,{modelValue:o.value.special,"onUpdate:modelValue":e[3]||(e[3]=t=>o.value.special=t)},null,8,["modelValue"])]),_:1}),a(l,{label:"\u7ED3\u5C40\u4E00"},{default:n(()=>[a(c,{modelValue:o.value.first,"onUpdate:modelValue":e[4]||(e[4]=t=>o.value.first=t)},null,8,["modelValue"])]),_:1}),a(l,{label:"\u7ED3\u5C40\u4E8C"},{default:n(()=>[a(c,{modelValue:o.value.second,"onUpdate:modelValue":e[5]||(e[5]=t=>o.value.second=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}};export{we as default};
